# [章番号]: [ユーザーシナリオ名] E2Eテスト仕様書

<!-- prettier-ignore -->
!!! note "このテンプレートの使い方"
  このファイルは、実際のユーザーシナリオに基づき、システム全体を通した動作を検証するE2E（End-to-End）テストの仕様を定義するためのテンプレートです。
  関連するユースケースと密接に連携し、ビジネス上クリティカルなフローに焦点を当てて記述します。
  詳しい使い方は「[テスト仕様の書き方ガイド](ここにガイドへのパスを記述してください)」を参照してください。

## 1. はじめに

### 1.1. 目的

<!-- このテストが何を検証するのかを記述します。（例: 新規ユーザーが登録からログイン、初回投稿までの一連のフローを問題なく完了できることを保証する） -->

### 1.2. テスト範囲

<!-- このテスト仕様書が対象とするユーザーシナリオと、対象としない範囲を明確にします。 -->

- **テスト対象範囲:**
  - [例: 登録ページのUIから、認証サービス、ユーザーDB、アプリケーションの投稿機能までの一連の連携]
  - [例: 決済ゲートウェイ連携を含む購入フロー]
- **テスト対象外:**
  - [例: 各UIコンポーネントの厳密な見た目（ビジュアルリグレッションテストの領域）]
  - [例: 個々のAPIの入力バリデーション（統合テストでカバー）]

## 2. 関連ユースケース

<!-- このE2Eテストがカバーする、ユースケースドキュメントへのリンクを記載します。 -->

- [UC001: ユーザー新規登録フロー](../../../../02_ユースケース/UC001_ユーザー新規登録フロー.md)
- [UC002: 初回投稿の作成](../../../../02_ユースケース/UC002_初回投稿の作成.md)

## 3. テスト環境

| 項目             | 内容                                                   |
| :--------------- | :----------------------------------------------------- |
| **実行環境**     | [例: ローカルDocker環境, ステージング環境]             |
| **Webブラウザ**  | [例: Chromium, Firefox, WebKit (Playwright)]           |
| **テストツール** | [例: Playwright, Cypress]                              |
| **テストデータ** | [例: 新規登録用の一時ユーザー、テスト用商品データなど] |

## 4. テストデータ管理

- **初期データ:**
  <!-- 各テストシナリオの実行前に必要なテストデータの投入方法を記述します。 -->
  [例: テスト実行前に、DBマイグレーションと基本データ（商品、カテゴリーなど）の投入を行う。]
- **テスト間の分離:**
  <!-- 各テストケースが他のテストに影響を与えないようにするための方針を記述します。 -->
  [例: 各テストケースは独立したテストユーザーを使用し、テスト終了後にユーザーアカウントを削除する。]

---

## 5. テストシナリオ

<!-- ここに、ユーザーの行動に基づいた具体的なE2Eテストシナリオを記述します。ユースケースの基本フローをさらに具体的な操作に落とし込みます。 -->

### 5.1. [E2Eシナリオ1] (例: 新規ユーザーのオンボーディング完了)

#### ケースID: `TC-E2E-ONBOARD-001`

- **テスト項目:** 新規ユーザーが、登録から初期設定完了までの一連のフローを問題なく完了できること。
- **テスト手順:**
  1. ウェブブラウザで、アプリケーションのサインアップページ (`/signup`) にアクセスする。
  2. 新しいユーザー情報（メールアドレス、パスワード）を入力し、「登録」ボタンをクリックする。
  3. メール認証画面が表示されることを確認する。
  4. (バックエンドAPIを直接叩き) 認証トークンを取得し、認証完了URLにアクセスする。
  5. アプリケーションに自動ログインされ、初期設定画面が表示されることを確認する。
  6. プロフィール情報（名前、タイムゾーン）を入力し、初期設定を完了する。
  7. ダッシュボード画面が表示され、正常に操作できることを確認する。
- **期待される結果:**
  - ユーザーがサインアップから初期設定までエラーなく進行し、ダッシュボードにアクセスできること。
  - 登録されたユーザー情報がデータベースに正しく保存されていること。
  - 画面遷移がスムーズに行われ、ローディング状態が適切に表示されること。
- **関連ユースケース:** `[UC001: ユーザー新規登録フロー]`
- **関連要件:** `[FUNC-AUTH-1-1]`, `[UI-ONBOARD-1-0]`

---

#### ケースID: `TC-E2E-ONBOARD-002`

- **テスト項目:** 登録済みのメールアドレスで新規登録を試み、適切なエラーが表示されること。
- **テスト手順:**
  1. 事前にテスト用のユーザーアカウントを作成しておく。
  2. サインアップページにアクセスし、手順1で作成したユーザーと同じメールアドレスで登録フォームを送信する。
- **期待される結果:**
  - エラーメッセージ「このメールアドレスは既に使用されています」が画面に表示されること。
  - データベースに新しいユーザーが作成されていないこと。
- **関連ユースケース:** `[UC001: ユーザー新規登録フロー]`
- **関連要件:** `[API-USER-1-2]`, `[UI-SIGNUP-1-1]`

---

## 6. 関連ドキュメント

- **システム仕様:** [(仕様書名)](../../../../01_システム仕様/README.md)
- **設計仕様:** [(設計書名)](../../../../03_設計仕様/README.md)
