# 02.Python コーディング規約

このドキュメントでは、`DevBlueprint`を利用するプロジェクトでPythonを記述する際の、コーディングスタイルと規約について定めます。
Webアプリケーション開発から、CI/CDの補助スクリプトまで、幅広い用途を想定しています。

!!! note "共通原則との関係"
    本規約は、**[01.共通/01_共通コーディング原則](../../01_共通/01_共通コーディング原則.md)**を、Python言語に特化・具体化したものです。必ず共通原則にも目を通してください。

---

## 1. 基本方針: PEP 8 準拠

*   本プロジェクトのコーディングスタイルは、Pythonの公式スタイルガイドである **[PEP 8](https://peps.python.org/pep-0008/)** に厳密に準拠します。
*   コードの可読性と一貫性を保つため、全てのPythonコードはPEP 8で定められたルールに従って記述してください。

---

## 2. 自動フォーマットとリンティングの強制

手作業でのスタイル遵守は非効率なため、自動化ツールによって規約の遵守を強制します。

*   **フォーマッター: `Black`**
    *   **役割:** 「議論の余地なく（uncompromising）」コードを整形するフォーマッター。細かいスタイルについて議論する時間をなくします。
    *   **公式サイト:** [Black - The Uncompromising Code Formatter](https://github.com/psf/black)
*   **リンター: `Ruff`**
    *   **役割:** 非常に高速なリンター兼フォーマッター。PEP 8違反だけでなく、潜在的なバグ（未使用の変数など）や、アンチパターンを検出します。`Flake8`など多くのツールの機能を内包しています。
    *   **公式サイト:** [Ruff - An extremely fast Python linter and code formatter](https://docs.astral.sh/ruff/)

!!! success "CI/CDとの連携"
    これらのツールをCI/CDプロセスに組み込むことで、規約に違反したコードのマージを自動的にブロックします。

---

## 3. 命名規則 (PEP 8より抜粋)

*   **`snake_case` (スネークケース):**
    *   関数名 (`def my_function():`)
    *   変数名 (`my_variable = 1`)
    *   モジュール名 (`my_module.py`)
*   **`PascalCase` (パスカルケース):**
    *   クラス名 (`class MyClass:`)
*   **`UPPER_SNAKE_CASE` (大文字のスネークケース):**
    *   定数 (`MY_CONSTANT = 100`)

---

## 4. 型ヒント (Type Hinting) の積極的利用

*   **全ての関数定義（引数と戻り値）**で、Python 3.5以降で導入された**型ヒント**を積極的に利用します。
*   これにより、コードの可読性が向上し、`mypy`や`Ruff`のような静的解析ツールによる型チェックが可能になり、コードの堅牢性が高まります。

    ```python
    def greet(name: str) -> str:
        return f"Hello, {name}"
    
    # 悪い例 (型ヒントがない)
    # def greet(name):
    #    return "Hello, " + name
    ```

---

## 5. 依存関係の管理

*   プロジェクトの依存ライブラリは、**`pyproject.toml`**で明確に管理します。
*   パッケージ管理ツールとして、**`Poetry`** や **`PDM`** の利用を推奨します。これらのツールは、依存関係の解決や仮想環境の管理を統合的に扱ってくれます。
*   これにより、プロジェクトの依存関係をグローバル環境から完全に分離させ、再現性を確保します。

---

## 6. 要求IDとの連携

*   **[01.共通コーディング原則](../../01_共通/01_共通コーディング原則.md)**で定められた通り、機能の実装に対応する要求IDをコメントとして明記します。

    ```python
    # REQ-API-2.1: ユーザー情報を返すAPI
    def get_user_by_id(user_id: int) -> dict:
        # ...
    ```
    