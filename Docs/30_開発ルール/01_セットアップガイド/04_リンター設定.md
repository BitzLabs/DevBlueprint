# 04 ãƒªãƒ³ã‚¿ãƒ¼è¨­å®š

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€ã‚³ãƒ¼ãƒ‰ã®å“è³ªå‘ä¸Šã¨ãƒã‚°ã®æ—©æœŸç™ºè¦‹ã®ãŸã‚ã®ãƒªãƒ³ã‚¿ãƒ¼ï¼ˆæ§‹æ–‡ãƒ»å“è³ªãƒã‚§ãƒƒã‚¯ãƒ„ãƒ¼ãƒ«ï¼‰ã®è¨­å®šã‚’è¡Œã„ã¾ã™ã€‚

## 1. ãƒªãƒ³ã‚¿ãƒ¼ã®æ¦‚è¦

### 1.1 ãƒªãƒ³ã‚¿ãƒ¼ã¨ã¯

ãƒªãƒ³ã‚¿ãƒ¼ã¯ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’é™çš„ã«è§£æã—ã€æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ã€æ½œåœ¨çš„ãªãƒã‚°ã€ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«ã®å•é¡Œã‚’æ¤œå‡ºã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ä¸»ãªåŠ¹æœï¼š

- **ãƒã‚°ã®æ—©æœŸç™ºè¦‹**: å®Ÿè¡Œå‰ã«ã‚¨ãƒ©ãƒ¼ã‚’æ¤œå‡º
- **ã‚³ãƒ¼ãƒ‰å“è³ªã®å‘ä¸Š**: ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã®å¼·åˆ¶
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å‘ä¸Š**: è„†å¼±æ€§ã®ã‚ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ¤œå‡º
- **ä¿å®ˆæ€§ã®å‘ä¸Š**: èª­ã¿ã‚„ã™ãç†è§£ã—ã‚„ã™ã„ã‚³ãƒ¼ãƒ‰ã®ä¿ƒé€²

### 1.2 ä½¿ç”¨ã™ã‚‹ãƒªãƒ³ã‚¿ãƒ¼

| ãƒªãƒ³ã‚¿ãƒ¼         | å¯¾è±¡è¨€èª/ãƒ•ã‚¡ã‚¤ãƒ«      | ç”¨é€”                         |
| ---------------- | ---------------------- | ---------------------------- |
| **ESLint**       | JavaScript, TypeScript | æ§‹æ–‡ãƒ»å“è³ªãƒã‚§ãƒƒã‚¯           |
| **markdownlint** | Markdown               | æ–‡æ›¸ã®æ§‹æ–‡ãƒ»ã‚¹ã‚¿ã‚¤ãƒ«ãƒã‚§ãƒƒã‚¯ |
| **stylelint**    | CSS, SCSS              | ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã®å“è³ªãƒã‚§ãƒƒã‚¯ |

## 2. ESLint ã®è¨­å®š

### 2.1 ESLint ã¨ã¯

ESLint ã¯ JavaScript/TypeScript ã®ãŸã‚ã®é™çš„è§£æãƒ„ãƒ¼ãƒ«ã§ã€ã‚³ãƒ¼ãƒ‰ã®å“è³ªã¨ã‚¹ã‚¿ã‚¤ãƒ«ã®ä¸€è²«æ€§ã‚’ä¿ã¡ã¾ã™ã€‚

### 2.2 ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š

```bash
# ESLint æœ¬ä½“ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install --save-dev eslint

# TypeScript ã‚µãƒãƒ¼ãƒˆ
npm install --save-dev @typescript-eslint/eslint-plugin @typescript-eslint/parser

# æ¨å¥¨è¨­å®šã¨ãƒ—ãƒ©ã‚°ã‚¤ãƒ³
npm install --save-dev eslint-config-prettier
npm install --save-dev eslint-plugin-import
npm install --save-dev eslint-plugin-node
npm install --save-dev eslint-plugin-promise
npm install --save-dev eslint-plugin-security
```

### 2.3 è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.eslintrc.jsonï¼‰ã®ä½œæˆ

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã« `.eslintrc.json` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ï¼š

```json
{
    "root": true,
    "env": {
        "node": true,
        "es2022": true,
        "browser": true,
        "jest": true
    },
    "extends": [
        "eslint:recommended",
        "@typescript-eslint/recommended",
        "plugin:import/errors",
        "plugin:import/warnings",
        "plugin:import/typescript",
        "plugin:node/recommended",
        "plugin:promise/recommended",
        "plugin:security/recommended",
        "prettier"
    ],
    "parser": "@typescript-eslint/parser",
    "parserOptions": {
        "ecmaVersion": "latest",
        "sourceType": "module",
        "project": "./tsconfig.json"
    },
    "plugins": ["@typescript-eslint", "import", "node", "promise", "security"],
    "rules": {
        // ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒ™ãƒ«ã®è¨­å®š
        "no-console": "warn",
        "no-debugger": "error",
        "no-unused-vars": "off",
        "@typescript-eslint/no-unused-vars": ["error", { "argsIgnorePattern": "^_" }],

        // ã‚¤ãƒ³ãƒãƒ¼ãƒˆé–¢é€£
        "import/order": [
            "error",
            {
                "groups": ["builtin", "external", "internal", "parent", "sibling", "index"],
                "newlines-between": "always"
            }
        ],
        "import/newline-after-import": "error",
        "import/no-duplicates": "error",

        // TypeScript å›ºæœ‰
        "@typescript-eslint/explicit-function-return-type": "off",
        "@typescript-eslint/explicit-module-boundary-types": "off",
        "@typescript-eslint/no-explicit-any": "warn",
        "@typescript-eslint/prefer-const": "error",
        "@typescript-eslint/no-unused-expressions": "error",

        // Node.js é–¢é€£
        "node/no-missing-import": "off",
        "node/no-unsupported-features/es-syntax": "off",
        "node/no-unpublished-import": "off",

        // ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é–¢é€£
        "security/detect-object-injection": "warn",
        "security/detect-non-literal-fs-filename": "warn",

        // Promise é–¢é€£
        "promise/always-return": "error",
        "promise/catch-or-return": "error",
        "promise/no-nesting": "warn"
    },
    "overrides": [
        {
            "files": ["*.js"],
            "rules": {
                "@typescript-eslint/no-var-requires": "off"
            }
        },
        {
            "files": ["*.test.{js,ts}", "**/__tests__/**/*"],
            "rules": {
                "security/detect-object-injection": "off",
                "node/no-unpublished-import": "off"
            }
        }
    ],
    "ignorePatterns": ["dist/", "build/", "node_modules/", "coverage/", "*.min.js"]
}
```

### 2.4 ç„¡è¦–ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.eslintignoreï¼‰ã®ä½œæˆ

ãƒªãƒ³ã‚¿ãƒ¼ã‚’å®Ÿè¡Œã—ãŸããªã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã™ã‚‹ãŸã‚ã€`.eslintignore` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ï¼š

```gitignore
# ä¾å­˜é–¢ä¿‚
node_modules/

# ãƒ“ãƒ«ãƒ‰çµæœ
dist/
build/
.next/
.nuxt/

# ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆ
coverage/
.nyc_output/

# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
*.config.js
*.config.ts

# è‡ªå‹•ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«
*.d.ts

# ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
docs/

# ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«
*.log
logs/

# ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«
.tmp/
.cache/
```

### 2.5 VS Code ã§ã® ESLint è¨­å®š

#### 2.5.1 æ‹¡å¼µæ©Ÿèƒ½ã®ç¢ºèª

ESLint ã® VS Code æ‹¡å¼µæ©Ÿèƒ½ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªï¼š

- **æ‹¡å¼µæ©Ÿèƒ½å**: ESLint
- **Extension ID**: `dbaeumer.vscode-eslint`

#### 2.5.2 VS Code è¨­å®šã®è¿½åŠ 

`.vscode/settings.json` ã«ä»¥ä¸‹ã®è¨­å®šã‚’è¿½åŠ ï¼š

```json
{
    // ESLint ã®è‡ªå‹•ä¿®æ­£
    "editor.codeActionsOnSave": {
        "source.fixAll.eslint": true
    },

    // ESLint ã®æ¤œè¨¼å¯¾è±¡
    "eslint.validate": ["javascript", "javascriptreact", "typescript", "typescriptreact"],

    // ESLint ã®å‹•ä½œè¨­å®š
    "eslint.run": "onType",
    "eslint.format.enable": false,

    // å•é¡Œã®è¡¨ç¤ºè¨­å®š
    "problems.decorations.enabled": true
}
```

### 2.6 package.json ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®è¿½åŠ 

`package.json` ã«ãƒªãƒ³ãƒˆç”¨ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¿½åŠ ã—ã¾ã™ï¼š

```json
{
    "scripts": {
        "lint": "eslint . --ext .js,.jsx,.ts,.tsx",
        "lint:fix": "eslint . --ext .js,.jsx,.ts,.tsx --fix",
        "lint:js": "eslint \"**/*.{js,jsx}\"",
        "lint:ts": "eslint \"**/*.{ts,tsx}\"",
        "lint:quiet": "eslint . --ext .js,.jsx,.ts,.tsx --quiet"
    }
}
```

## 3. markdownlint ã®è¨­å®š

### 3.1 markdownlint ã¨ã¯

markdownlint ã¯ Markdown ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ«ã¨æ§‹æ–‡ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ãƒªãƒ³ã‚¿ãƒ¼ã§ã™ã€‚

### 3.2 ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# markdownlint ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install --save-dev markdownlint-cli
```

### 3.3 è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.markdownlint.jsonï¼‰ã®ä½œæˆ

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã« `.markdownlint.json` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ï¼š

```json
{
    "default": true,
    "MD003": { "style": "atx" },
    "MD007": { "indent": 2 },
    "MD010": { "spaces_per_tab": 2 },
    "MD013": { "line_length": 150 },
    "MD024": { "allow_different_nesting": true },
    "MD033": { "allowed_elements": ["br", "kbd", "sub", "sup"] },
    "MD034": false,
    "MD041": false
}
```

### 3.4 VS Code ã§ã® markdownlint è¨­å®š

#### 3.4.1 æ‹¡å¼µæ©Ÿèƒ½ã®ç¢ºèª

markdownlint ã® VS Code æ‹¡å¼µæ©Ÿèƒ½ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªï¼š

- **æ‹¡å¼µæ©Ÿèƒ½å**: markdownlint
- **Extension ID**: `davidanson.vscode-markdownlint`

#### 3.4.2 VS Code è¨­å®šã®è¿½åŠ 

`.vscode/settings.json` ã«ä»¥ä¸‹ã®è¨­å®šã‚’è¿½åŠ ï¼š

```json
{
    // Markdown ã®è‡ªå‹•ä¿®æ­£
    "editor.codeActionsOnSave": {
        "source.fixAll.markdownlint": true
    },

    // Markdown ãƒ•ã‚¡ã‚¤ãƒ«ã®è¨­å®š
    "[markdown]": {
        "editor.defaultFormatter": "yzhang.markdown-all-in-one",
        "editor.wordWrap": "on",
        "editor.quickSuggestions": {
            "comments": "off",
            "strings": "off",
            "other": "off"
        }
    }
}
```

### 3.5 package.json ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®è¿½åŠ 

```json
{
    "scripts": {
        "lint:md": "markdownlint \"**/*.md\"",
        "lint:md:fix": "markdownlint \"**/*.md\" --fix"
    }
}
```

## 4. stylelint ã®è¨­å®šï¼ˆCSS ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å ´åˆï¼‰

### 4.1 ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

CSS/SCSS ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆï¼š

```bash
# stylelint ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install --save-dev stylelint stylelint-config-standard
npm install --save-dev stylelint-config-prettier
```

### 4.2 è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.stylelintrc.jsonï¼‰ã®ä½œæˆ

```json
{
    "extends": ["stylelint-config-standard", "stylelint-config-prettier"],
    "rules": {
        "indentation": 2,
        "string-quotes": "single",
        "color-hex-case": "lower",
        "color-hex-length": "short",
        "selector-combinator-space-after": "always",
        "selector-attribute-brackets-space-inside": "never",
        "selector-attribute-operator-space-after": "never",
        "selector-attribute-operator-space-before": "never",
        "selector-attribute-quotes": "always",
        "declaration-colon-space-after": "always",
        "declaration-colon-space-before": "never",
        "function-url-quotes": "always",
        "media-feature-colon-space-after": "always",
        "media-feature-colon-space-before": "never"
    },
    "ignoreFiles": ["node_modules/**/*", "dist/**/*", "build/**/*"]
}
```

### 4.3 package.json ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®è¿½åŠ 

```json
{
    "scripts": {
        "lint:css": "stylelint \"**/*.{css,scss}\"",
        "lint:css:fix": "stylelint \"**/*.{css,scss}\" --fix"
    }
}
```

## 5. çµ±åˆ lint ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

### 5.1 å…¨ä½“ã®ãƒªãƒ³ã‚¿ãƒ¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

`package.json` ã«çµ±åˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¿½åŠ ï¼š

```json
{
    "scripts": {
        "lint:all": "npm run lint && npm run lint:md && npm run lint:css",
        "lint:fix:all": "npm run lint:fix && npm run lint:md:fix && npm run lint:css:fix",
        "prelint": "echo 'ğŸ” Running linters...'",
        "postlint": "echo 'âœ… Linting completed!'"
    }
}
```

## 6. ãƒªãƒ³ã‚¿ãƒ¼ã®å‹•ä½œç¢ºèª

### 6.1 ESLint ã®å‹•ä½œç¢ºèª

1. **ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ**

    ```javascript
    // test-eslint.js
    var unused_var = 123;
    console.log('Hello World');

    function test() {
        let a = 1;
        let b = 2;
        return a + b;
    }

    const obj = { a: 1, b: 2 };
    ```

2. **ãƒªãƒ³ã‚¿ãƒ¼ã®å®Ÿè¡Œ**

    ```bash
    npx eslint test-eslint.js
    ```

3. **æœŸå¾…ã•ã‚Œã‚‹ã‚¨ãƒ©ãƒ¼**
    - `unused_var` ãŒæœªä½¿ç”¨
    - ã‚»ãƒŸã‚³ãƒ­ãƒ³ãŒä¸è¶³
    - ã‚¹ãƒšãƒ¼ã‚¹ã®å•é¡Œãªã©

### 6.2 markdownlint ã®å‹•ä½œç¢ºèª

1. **ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ**

    ```markdown
    # Test Document

    This is a test.

    ##Bad heading

    - item 1
    - item 2
    ```

2. **ãƒªãƒ³ã‚¿ãƒ¼ã®å®Ÿè¡Œ**

    ```bash
    npx markdownlint test.md
    ```

### 6.3 VS Code ã§ã®ç¢ºèª

1. **å•é¡Œãƒ‘ãƒãƒ«ã®ç¢ºèª**
    - `Ctrl+Shift+M` ã§å•é¡Œãƒ‘ãƒãƒ«ã‚’é–‹ã
    - ãƒªãƒ³ã‚¿ãƒ¼ã®ã‚¨ãƒ©ãƒ¼ã¨è­¦å‘ŠãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

2. **è‡ªå‹•ä¿®æ­£ã®ç¢ºèª**
    - ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã—ã¦è‡ªå‹•ä¿®æ­£ãŒå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª

## 7. CI/CD ã¨ã®çµ±åˆ

### 7.1 GitHub Actions ã®ä¾‹

```yaml
# .github/workflows/lint.yml
name: Lint Check
on: [push, pull_request]

jobs:
    lint:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v3
            - uses: actions/setup-node@v3
              with:
                  node-version: '18'
            - run: npm install
            - run: npm run lint:all
```

### 7.2 pre-commit hooks ã®è¨­å®š

Husky ã‚’ä½¿ç”¨ã—ãŸä¾‹ï¼š

```json
{
    "husky": {
        "hooks": {
            "pre-commit": "npm run lint:fix:all"
        }
    }
}
```

## 8. ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

#### ESLint ãŒå‹•ä½œã—ãªã„

1. **è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª**
    - `.eslintrc.json` ã® JSON æ§‹æ–‡ã‚’ãƒã‚§ãƒƒã‚¯
    - ãƒ‘ãƒ¼ã‚µãƒ¼ã¨ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®äº’æ›æ€§ã‚’ç¢ºèª

2. **ä¾å­˜é–¢ä¿‚ã®ç¢ºèª**
    - å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

3. **VS Code ã®è¨­å®šç¢ºèª**
    - ESLint æ‹¡å¼µæ©Ÿèƒ½ãŒæœ‰åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

#### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®å•é¡Œ

1. **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®çµã‚Šè¾¼ã¿**
    - `.eslintignore` ã§ä¸è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚’é™¤å¤–

2. **ãƒ«ãƒ¼ãƒ«ã®èª¿æ•´**
    - é‡ã„ãƒ«ãƒ¼ãƒ«ã‚’ç„¡åŠ¹åŒ–ã¾ãŸã¯è­¦å‘Šãƒ¬ãƒ™ãƒ«ã«å¤‰æ›´

#### è¨­å®šã®ç«¶åˆ

1. **Prettier ã¨ã®çµ±åˆ**
    - `eslint-config-prettier` ã§ç«¶åˆã™ã‚‹ãƒ«ãƒ¼ãƒ«ã‚’ç„¡åŠ¹åŒ–

2. **ã‚¨ãƒ‡ã‚£ã‚¿è¨­å®šã®å„ªå…ˆé †ä½**
    - VS Code ã®è¨­å®šã¨ãƒªãƒ³ã‚¿ãƒ¼è¨­å®šã®æ•´åˆæ€§ã‚’ç¢ºèª

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

ãƒªãƒ³ã‚¿ãƒ¼ã®è¨­å®šãŒå®Œäº†ã—ãŸã‚‰ã€æ¬¡ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®è¨­å®šã«ã¤ã„ã¦å­¦ç¿’ã—ã¾ã™ï¼š

â†’ **[05\_ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®è¨­å®š.md](./05_ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®è¨­å®š.md)**
