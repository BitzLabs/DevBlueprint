# テストのライフサイクル管理規定

本規定は、テストコードとテストケースがプロダクトの進化に合わせて健全な状態を保ち続けるためのレビュー、メンテナンス、および管理プロセスを定めます。

## 目的

- テストの品質と信頼性を維持する
- 仕様変更に追随できていない、陳腐化したテストをなくす
- 回帰テストスイートを最適化し、CIの実行時間と効果のバランスを取る
- テストに関するチーム内の共通認識を醸成する

## 1. テストコードのレビュー

- **対象**: 新規追加または変更された全てのテストコード（単体、結合、E2Eなど）。
- **タイミング**: 機能コードのPull Requestレビューと同時に実施します。
- **観点**:
    - `20_テスト規定` 配下の各規約を遵守しているか。
    - テストの意図が明確か（命名、AAAパターンなど）。
    - 不安定な要素（ハードコーディングされた待機時間など）を含んでいないか。
    - アサーションは適切かつ十分か。
    - 変更された機能コードを十分にカバーしているか。

## 2. テストの陳腐化対応 (Test Maintenance)

- **検知**:
    - CIで頻繁に失敗するテスト (Flaky Test)。
    - 仕様変更やリファクタリングにより、存在意義がなくなったテスト。
    - カバレッジレポートで、長期間実行されていない、あるいはどのプロダクトコードもカバーしなくなったテスト。
- **対応プロセス**:
    1. 担当者は、陳腐化したテストを特定した場合、修正または削除のためのIssueを作成します。
    2. Issueには、対象テスト、陳腐化した理由、提案する対応（修正/削除）を明記します。
    3. チーム（またはQAリード）はIssueをレビューし、対応を決定します。テストの削除は、そのテストがカバーしていたリスクを理解した上で慎重に行います。

## 3. 回帰テストスイートの管理

- **追加基準**: 以下のケースでは、対応する自動テストを主要な回帰テストスイートに含めることを検討します。
    - クリティカルなビジネスフロー（認証、決済、主要なデータ作成など）に関わるテスト。
    - 過去に重大な不具合が発生した機能の再発防止テスト。
    - 複数の機能に影響を与える共通モジュールやコアロジックのテスト。
- **見直し**:
    - 四半期ごと、またはメジャーリリース後に回帰テストスイート全体を見直します。
    - 実行時間、失敗率、カバー範囲を評価し、価値が低くなったテストの削除や、より効果的なテストへの置き換えを検討します。
