# セキュリティテスト規定

本規定は、アプリケーションおよびインフラ層におけるセキュリティテストの方針・実施手順・判定基準を定めます。OWASP ASVS/WSTG と OWASP Top 10 を主参照とし、CI による自動化と定期的な手動診断を組み合わせます。

## 対象範囲

- アプリケーション層（API/フロントエンド/バックエンド）
- 認証・認可、セッション管理、入力検証、エラーハンドリング、ログ
- 外部依存（ライブラリ、外部API、SaaS）

## テストレベルと実施タイミング

- PR単位（自動）: 依存関係監査、静的解析、シークレット検知、軽量 DAST
- リリース前（自動+半手動）: 強化 DAST、構成レビュー、脆弱性再検証
- 四半期/大規模変更時（手動）: 標的型診断（WSTG ベース）、権限昇格/多要素認証/セッション固定 などの重点検査

## 自動テスト（推奨ツール例）

- 依存関係監査: npm audit、GitHub Dependabot、OSS Index（失敗閾値: High 以上でブロック）
- SAST: ESLint + eslint-plugin-security、型・入力検証ガード（zod 等）の有無チェック
- シークレット検知: gitleaks/secretlint（PR と main に対して実行）
- DAST: OWASP ZAP baseline（主要エンドポイント、認証後シナリオを含む）
- ヘッダ・TLS 構成: securityheaders.com 等の自動チェック（CSP/HSTS/Referrer-Policy 等）

## 手動テスト観点（主要抜粋）

- 認証・認可: ロール/テナント越境、IDOR、不適切なアクセス制御
- 入力検証: XSS、SQLi/NoSQLi、ファイルアップロード検証、テンプレートインジェクション
- セッション/CSRF: セッション固定/劣化、CSRF トークン検証、SameSite/Cookie 属性
- エラーハンドリング: スタックトレースや機微情報の露出防止
- ログ/監査: PII マスキング、失敗イベントの記録、改ざん検知

## 判定とエスカレーション

- 重大度定義（CVE/CVSS 参考）
    - Critical: 24h 以内に回避策適用/リリースブロック
    - High: 3 営業日以内に修正計画/優先対応
    - Medium: 7 営業日以内に修正チケット化
    - Low: 次スプリント以降に計画

## エビデンス・成果物

- 自動診断レポート（CI 生成）: [../..](../..) の [40\_自動テスト](../40_自動テスト/README.md) 配下に格納
- 手動診断チェックリストと再現手順: [../..](../..) の [30\_テストケース](../30_テストケース/README.md) 配下に格納
- 修正チケット: Issue に脆弱性 ID/再現条件/影響範囲/回避策を記載

## 例外運用

- 一時的な例外はセキュリティ責任者承認を必須とし、有効期限と恒久対策を明記
- 例外はリリースノートと脆弱性台帳に記録し、期限超過を自動通知

## 参考

- OWASP ASVS / WSTG / Top 10
- CWE、CIS Benchmarks、NIST 800-53
