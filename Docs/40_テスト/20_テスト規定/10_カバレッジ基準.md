# カバレッジ基準

本規定は、テストカバレッジの定義、対象範囲、しきい値、例外運用、レポート方針を定めます。

## 指標

- Statement/Line、Branch、Function、Class（適用可能な場合）
- Mutation score（導入可能な場合は将来的に検討）

## 対象/除外

- 対象: 事業ロジック、ドメイン層、ユーティリティ、UI のロジック部分
- 除外: 自動生成コード、型定義、単純な DTO、設定ファイル、マイグレーションのスケルトン
- 除外は `/* istanbul ignore next */` 等で最小限に限定し、README に理由を明示

## しきい値（暫定）

- Line/Statement: 80% 以上
- Branch: 70% 以上
- Function: 80% 以上
- クリティカルモジュール（支払い、権限など）は個別に 90% 以上を目標

## 判定と継続的改善

- CI でしきい値未達は失敗。直近コミット差分での後退を防止（diff coverage）
- 例外はチケットに記録し、改善期限と担当を明記
- カバレッジは品質の十分条件ではないため、重要フローはテストケースで補完

## レポート

- HTML/LCOV を生成し、CI アーティファクトとして保存
- 主要モジュールのトレンドを週次ダッシュボードで可視化
