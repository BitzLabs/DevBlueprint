# テストデータ・フィクスチャ規定

本規定は、テストデータの分類、生成、匿名化、配置、寿命管理、再現性を担保するための原則を定めます。

## データ分類

- 合成データ（推奨）: 生成スクリプトで再現可能、PII を含まない
- 複製データ（限定）: 本番データを匿名化・縮約したもの。承認と監査ログ必須
- サンプルデータ: ドキュメント用の最小セット。README に意図と使用例を明記

## 生成と匿名化

- 生成: factory（テストコード）、seed スクリプト（開発環境）、Faker 系ライブラリ
- 匿名化: 直接識別子の削除/トークン化、準識別子の汎化・ノイズ注入、ユニーク性維持
- 追跡可能性: 生成パラメータを commit し、同一ハッシュで再生成可能にする

## 配置と寿命

- 単体テスト: フィクスチャはテスト単位で生成・破棄（テスト間独立）
- 結合/E2E: seed により初期状態を作成し、テスト終了時にクリーンアップ
- 共有環境: スナップショット/リセット手順を整備し、定期自動リセット

## バージョニング

- スキーマ変更に追随するようフィクスチャにバージョンを付与
- 破壊的変更はマイグレーションスクリプトを同梱

## セキュリティ/コンプライアンス

- PII/機微情報の持ち込み禁止。やむを得ない場合は DPO 承認と暗号化保管
- アクセス権限を最小化し、転送時は暗号化を必須とする

## エビデンス

- 生成スクリプト/seed の場所と実行手順を README に明記
- CI で seed 実行ログを保存し、再現性を確認
