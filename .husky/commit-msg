#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# ğŸš€ DevBlueprint ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒã‚§ãƒƒã‚¯
echo "ğŸ“ Conventional Commitså½¢å¼ã‚’ãƒã‚§ãƒƒã‚¯ä¸­..."

# ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å–ã‚Š
commit_msg=$(cat "$1")

# Conventional Commitså½¢å¼ã®æ­£è¦è¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³
# å½¢å¼: type(scope): subject
# type: feat, fix, docs, style, refactor, perf, test, build, ci, chore
# scope: ã‚ªãƒ—ã‚·ãƒ§ãƒ³
# subject: å¿…é ˆï¼ˆ1-50æ–‡å­—ï¼‰
pattern="^(feat|fix|docs|style|refactor|perf|test|build|ci|chore)(\(.+\))?: .{1,50}$"

if ! echo "$commit_msg" | head -n 1 | grep -qE "$pattern"; then
    echo "âŒ ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒ Conventional Commits å½¢å¼ã«å¾“ã£ã¦ã„ã¾ã›ã‚“"
    echo ""
    echo "ğŸ“‹ æ­£ã—ã„å½¢å¼:"
    echo "   type(scope): subject"
    echo ""
    echo "ğŸ“‹ ä½¿ç”¨å¯èƒ½ãªtype:"
    echo "   feat:     æ–°æ©Ÿèƒ½"
    echo "   fix:      ãƒã‚°ä¿®æ­£"
    echo "   docs:     ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå¤‰æ›´"
    echo "   style:    ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«ä¿®æ­£"
    echo "   refactor: ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°"
    echo "   perf:     ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„"
    echo "   test:     ãƒ†ã‚¹ãƒˆè¿½åŠ ãƒ»ä¿®æ­£"
    echo "   build:    ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ å¤‰æ›´"
    echo "   ci:       CI/CDè¨­å®šå¤‰æ›´"
    echo "   chore:    ãã®ä»–ã®å¤‰æ›´"
    echo ""
    echo "ğŸ“‹ ä¾‹:"
    echo "   feat(auth): ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ã‚’è¿½åŠ "
    echo "   fix(api): ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ã®ãƒã‚°ã‚’ä¿®æ­£"
    echo "   docs: README.mdã«ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †ã‚’è¿½åŠ "
    echo ""
    echo "ç¾åœ¨ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: $commit_msg"
    exit 1
fi

echo "âœ… ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé©åˆ‡ã§ã™"
